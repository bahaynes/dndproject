{
    debug
    email admin@bahaynes.com
}

http://dndproject.bahaynes.com {
    redir https://{host}{uri}
}

https://dndproject.bahaynes.com {
    tls {
        dns cloudflare {env.CLOUDFLARE_API_TOKEN}
    }
    encode gzip

    # API requests
    @api path /api/*
    handle @api {
        uri strip_prefix /api
        reverse_proxy backend:8000
    }

    # All other requests (frontend)
    handle {
        root * /srv
        try_files {path} /index.html
        file_server
    }
}
