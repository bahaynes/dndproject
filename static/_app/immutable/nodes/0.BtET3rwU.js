import"../chunks/DsnmJJEf.js";import{o as F}from"../chunks/CI0O81D0.js";import{p as H,f as l,a1 as _,a as n,b as M,c as t,s as i,r as o,e as R,n as U,k as W}from"../chunks/BQgaxF8b.js";import{e as q,s as C}from"../chunks/DZdyVSBA.js";import{i as b}from"../chunks/Dw9ZWyUX.js";import{s as E}from"../chunks/CIk_3UuT.js";import{s as G,a as I}from"../chunks/SOJ9lwBg.js";import{a as s}from"../chunks/DETFAPFB.js";import{g as J}from"../chunks/Dbi8v1WO.js";var K=l('<span class="px-4"> </span>'),N=l('<a href="/dashboard" class="px-4 hover:underline">Dashboard</a> <!> <button class="px-4 hover:underline">Logout</button>',1),O=l('<a href="/login" class="px-4 hover:underline">Login</a> <a href="/register" class="px-4 hover:underline">Register</a>',1),P=l('<header class="bg-gray-800 text-white p-4"><nav class="container mx-auto flex justify-between"><a href="/" class="font-bold">DnD Hub</a> <div><!></div></nav></header> <main><!></main>',1);function ra(x,p){H(p,!0);const[k,y]=G(),e=()=>I(s,"$auth",k);F(async()=>{if(e().isAuthenticated&&!e().user)try{const a=await fetch("http://localhost:8000/users/me/",{headers:{Authorization:`Bearer ${e().token}`}});if(a.ok){const r=await a.json();s.setUser(r)}else s.logout()}catch(a){console.error("Failed to fetch user profile",a),s.logout()}});function w(){s.logout(),J("/login")}var h=P(),u=_(h),m=t(u),v=i(t(m),2),$=t(v);{var A=a=>{var r=N(),g=i(_(r),2);{var j=c=>{var f=K(),B=t(f);o(f),W(()=>C(B,`Welcome, ${e().user.username??""}`)),n(c,f)};b(g,c=>{e().user&&c(j)})}var z=i(g,2);q("click",z,w),n(a,r)},D=a=>{var r=O();U(2),n(a,r)};b($,a=>{e().isAuthenticated?a(A):a(D,!1)})}o(v),o(m),o(u);var d=i(u,2),L=t(d);E(L,()=>p.children??R),o(d),n(x,h),M(),y()}export{ra as component};
